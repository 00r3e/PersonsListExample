@model IEnumerable<PersonResponse>

@{
	ViewBag.Title = "Persons";
	ViewBag.CurrentUrl = "~/Persons/Index";
}

<form asp-controller="Persons" asp-action="Index" method="get">
	<div class="d-flex justify-content-between align-items-center flex-wrap mb-4">
		<h2 class="fw-semibold text-accent mb-0">
			<i class="fa-solid fa-users me-2"></i>Persons
		</h2>
		<div class="d-flex flex-wrap gap-2">
			<a asp-controller="Persons" asp-action="Create" class="btn btn-accent rounded-pill px-3">
				<i class="fa-solid fa-plus me-1"></i> Create
			</a>
			<a asp-controller="Persons" asp-action="PersonsPDF" class="btn btn-outline-light rounded-pill px-3">
				<i class="fa-solid fa-file-pdf me-1"></i> PDF
			</a>
			<a asp-controller="Persons" asp-action="PersonsCSV" class="btn btn-outline-light rounded-pill px-3">
				<i class="fa-solid fa-file-csv me-1"></i> CSV
			</a>
			<a asp-controller="Persons" asp-action="PersonsExcel" class="btn btn-outline-light rounded-pill px-3">
				<i class="fa-solid fa-file-excel me-1"></i> Excel
			</a>
		</div>
	</div>

	<!-- Search Section -->
	<div class="card dark-card border-0 shadow-sm mb-4 rounded-4">
		<div class="card-body">
			<div class="row g-3 align-items-end">
				<div class="col-md-3">
					<label class="form-label text-light fw-medium">Search by</label>
					<select class="form-select dark-input rounded-pill" name="searchBy">
						@foreach (var field in ViewBag.SearchFields)
						{
							<option value="@field.Key" selected="@(field.Key == ViewBag.CurrentSearchBy ? "selected" : null)">
								@field.Value
							</option>
						}
					</select>
				</div>

				<div class="col-md-4">
					<label class="form-label text-light fw-medium">Search</label>
					<input type="search" class="form-control dark-input rounded-pill" name="searchString" placeholder="Enter keyword..." value="@ViewBag.CurrentSearchString" />
				</div>

				<div class="col-md-2 d-grid">
					<button class="btn btn-accent rounded-pill">
						<i class="fa-solid fa-search me-1"></i>Search
					</button>
				</div>

				<div class="col-md-2 d-grid">
					<a asp-controller="Persons" asp-action="Index" class="btn btn-outline-light rounded-pill">
						Clear
					</a>
				</div>
			</div>
		</div>
	</div>

	<!-- Data Table -->
	<div class="card dark-card border-0 shadow-sm rounded-4">
		<div class="table-responsive">
			<table class="table table-dark table-hover align-middle mb-0">
				<thead class="table-accent">
					<tr>
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.PersonName) }, { "DisplayName", "Person Name" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.Email) }, { "DisplayName", "Email" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.DateOfBirth) }, { "DisplayName", "Date of Birth" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.Age) }, { "DisplayName", "Age" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.Gender) }, { "DisplayName", "Gender" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.Country) }, { "DisplayName", "Country" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.Address) }, { "DisplayName", "Address" } })
						@await Html.PartialAsync("/Views/Shared/_GridColumnHeading.cshtml", new ViewDataDictionary(ViewData) { { "ColumnName", nameof(PersonResponse.ReceiveNewsLetters) }, { "DisplayName", "Receive News Letters" } })
						<th class="text-center text-light">Actions</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var person in Model)
					{
						<tr>
							<td>@person.PersonName</td>
							<td>@person.Email</td>
							<td>@person.DateOfBirth?.ToString("dd MMM yyyy")</td>
							<td>@person.Age</td>
							<td>@person.Gender</td>
							<td>@person.Country</td>
							<td>@person.Address</td>
							<td>@person.ReceiveNewsLetters</td>
							<td class="text-center">
								<a asp-controller="Persons" asp-action="Edit" asp-route-personID="@person.PersonID" class="btn btn-sm btn-outline-accent rounded-pill me-2">
									<i class="fa-solid fa-pen"></i>
								</a>
								<a asp-controller="Persons" asp-action="Delete" asp-route-personID="@person.PersonID" class="btn btn-sm btn-outline-danger rounded-pill">
									<i class="fa-solid fa-trash"></i>
								</a>
							</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
	</div>
</form>
